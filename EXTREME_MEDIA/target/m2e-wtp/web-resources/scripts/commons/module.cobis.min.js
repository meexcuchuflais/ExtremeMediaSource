(function(b,f,d,a,c){var e=c.createModule(c.modules.CONTAINER,["ui.bootstrap","ngCookies"]);e.config(["$httpProvider",function(g){if(!g.defaults.headers.get){g.defaults.headers.get={}}g.defaults.headers.get["If-Modified-Since"]="0";g.interceptors.push("cobisHttpInterceptor")}]);e.factory("cobisHttpInterceptor",["$q","$timeout",function(g,h){var i={request:function(j){if(j.url.indexOf("${contextPath}/resources/")>-1){j.restUrl=true;if(!j.method){j.method="PUT"}if(j.params){if(!j.params.hasOwnProperty("returnOnlyData")){j.params.returnOnlyData=true}if(!j.params.hasOwnProperty("exceptionHandling")){j.params.exceptionHandling=true}}else{j.params={returnOnlyData:true,exceptionHandling:true}}}else{j.restUrl=false;if(j.url.indexOf("${contextPath}/cobis/web/assets/languages/")>-1){if(j.params){if(!j.params.hasOwnProperty("returnOnlyData")){j.params.returnOnlyData=true}if(!j.params.hasOwnProperty("exceptionHandling")){j.params.exceptionHandling=true}}else{j.params={returnOnlyData:true,exceptionHandling:true}}}}return j},response:function(j){var l=j.data,k;if(j.config.restUrl&&l){if(l.hasOwnProperty("sucess")){j.data.result=l.sucess}else{if(l.hasOwnProperty("success")){j.data.result=l.success}}if(!j.data.result){k=l.messages;if(k[0]&&k[0].code==80103){if(top.location==self.location){d("#lockscreen").show()}else{window.parent.$("#lockscreen").show()}return g.reject(j)}else{if(j.config.params.exceptionHandling){c.getMessageManager().showMessagesError(k);return g.reject(j)}}}if(j.config.params.returnOnlyData){j.data=l.data}else{j.data=l}}return j},requestError:function(j){if(j.config.params.exceptionHandling){c.getMessageManager().showMessagesError(j.statusText)}else{throw new c.CobisException(j.statusText)}return g.reject(j)},responseError:function(j){var m=j.statusText,k,l;if(b.isDefined(j.config.params)&&j.config.params.exceptionHandling){if(j.config.url&&j.config.url.indexOf("${contextPath}/cobis/web/assets/languages/")>-1&&j.status==404){k=j.config.url.split("/");l=k[k.length-1];h(function(){m=c.translate("COMMONS.CONTAINER.MSG_NOT_FOUND_LANGUAGE_RESOURCE")+": "+l;c.getMessageManager().showMessagesError(m)},100)}}else{if(j.status===0&&j.data===null&&j.statusText===""){h(function(){m=c.translate("COMMONS.CONTAINER.MSG_NETWORK_UNAVAILABLE");c.getMessageManager().showMessagesError(m)},100)}else{throw new c.CobisException(j.statusText)}}if(j.config.url.indexOf("${contextPath}/cobis/web/assets/languages/")>-1){return{data:{}}}else{if(j.status===0&&j.data===null&&j.statusText===""){h(function(){m=c.translate("COMMONS.CONTAINER.MSG_NETWORK_UNAVAILABLE");c.getMessageManager().showMessagesError(m)},100)}else{return g.reject(j)}}}};return i}]);e.service(c.modules.CONTAINER+".reportingService",["$q","$http",function(h,j){function g(m){if(m.module===undefined){c.showMessageWindow.alertError(c.translate("COMMONS.REPORT.MSG_MODULE_NAME_REQUIRED")).done(function(n){});console.log("Module name is required");return null}if(m.name===undefined){c.showMessageWindow.alertError(c.translate("COMMONS.REPORT.MSG_REPORT_NAME_REQUIRED")).done(function(n){});console.log("Report name is required");return null}if(m.title===undefined){m.title=m.module+" "+m.name}var l="/CTSProxy/services/cobis/web/reporting/actions/reportingService?report.module="+m.module+"&report.name="+m.name;var k="";if(m.parameters!=undefined){d.each(m.parameters,function(o,n){if(o!=undefined&&n!=undefined){k+="&"+o+"="+n}})}l+=k;return l}var i={showOnTab:function(l){console.log("Show report on tab",l);var k=g(l);if(k!==null){c.container.tabs.openNewTab(0,k,l.title,true)}},showOnPopup:function(m){console.log("Show report on popup",m);if(m.screen.height===undefined){m.screen.height=500}if(m.screen.width===undefined){m.screen.width=500}var l=g(m);if(l!==null){var n=["height="+m.screen.height,"width="+m.screen.width,"fullscreen=yes"].join(",");var k=window.open(l,"popup_window_"+m.title,n);k.moveTo(0,0)}}};return i}]);e.service(c.modules.CONTAINER+".menuContainer",["$translate","$q","$http","$timeout",function(l,h,n,k){var g={},m,j;g.getListMenuFiles=function(){var i=h.defer();n({url:"${contextPath}/resources/cobis/web/container/menu/getListMenuFiles",method:"GET",data:null}).success(function(u,t,p,q){var x=[],r=[],s=[],v=u.validFiles,w=u.invalidFiles,o=u.ignoredFiles;if(w){w.forEach(function(y){s.push({message:y,type:0})});k(function(){var y=c.translate("COMMONS.CONTAINER.MSG_INVALID_RESOURCE_FILE")+": ";s.unshift({message:y,type:0});c.getMessageManager().showMessagesError(s)},200)}m=[];if(o){v.forEach(function(y){o.forEach(function(z){if(y.indexOf(z)<0){m.push(y)}})})}else{m=v}m.forEach(function(z){var A=z.split("-"),y=A[0]+"-"+A[1];x.push(y)});x.forEach(function(z){var y=true;for(j=0;j<=r.length;j+=1){if(z==r[j]){y=false;break}}if(y==true){r.push(z)}});i.resolve(r)}).error(function(q,o,r,p){i.reject(null)});return i.promise};return g}]);e.service(c.modules.CONTAINER+".containerInfoService",["$q","$http",function(h,i){var g={};g.getProcessDate=function(){var j=h.defer();i({url:"${contextPath}/resources/cobis/web/security/getProcessDate",method:"PUT",data:null,params:{returnOnlyData:false,exceptionHandling:true}}).success(function(m,k,n,l){if(k!=="500"){if(b.isDefined(m)&&m.result){j.resolve(m.data)}else{j.reject(null)}}else{j.reject(null)}}).error(function(m,k,n,l){j.reject(null)});return j.promise};g.keepAliveSessionOnCen=function(){var j=h.defer();i({url:"${contextPath}/resources/cobis/web/security/validateUserSession",method:"GET",data:null,params:{returnOnlyData:false,exceptionHandling:false}}).success(function(m,k,n,l){if(k!="500"){j.resolve(m)}else{j.reject(null)}}).error(function(m,k,n,l){j.reject(null)});return j.promise};return g}]);e.service("cobisMessage",["$filter","$compile","$rootScope",function(m,j,n){var i=[{originalChar:"'",replaceChar:'"'}];function o(r){var q=r;i.forEach(function(s){q=q.replace(new RegExp(s.originalChar,"g"),s.replaceChar)});return q}function g(q,r){if(q!=null&&r!=null){q=d.validator.format(q);q=q(r);console.log(q)}return q}function p(u){var B,s,v,t,y=[],z,w="",C=a.notifier(),x,A=null,q,r=null;if(u instanceof Array){y=u}else{y.push(u)}for(v=0;v<y.length;v+=1){q=false;if(b.isUndefined(y[v].code)||y[v].code===-1){if(b.isDefined(y[v].parameters)&&b.isArray(y[v].parameters)){w="{";for(t=0;t<y[v].parameters.length;t+=1){if(t>0){w+=","}w+=('"p'+t+'":"'+y[v].parameters[t]+'"')}w+="}"}if(w){z=j("<div>{{'"+o(y[v].message)+"'|translate:'"+w+"'}}</div>")(n)}else{z=j("<div>{{'"+o(y[v].message)+"'|translate}}</div>")(n)}}else{z="<div>"+y[v].message+"</div>";if(b.isDefined(y[v].parameters)&&b.isArray(y[v].parameters)){z=g(z,u[v].parameters)}}if((b.isDefined(y[v].showAsWindow)&&y[v].showAsWindow)){q=true}else{q=false}x=y[v].type;if(x==="undefined"){x=c.constant.TYPEMESSAGE.INFO}switch(x){case c.constant.TYPEMESSAGE.ERROR:if(y[v].showAsWindow===undefined){q=true}if(q){r=y[v].code;z=c.translate(y[v].message,w);if(r!=-1){z=z+'<div class="text-muted small cb-gap-top">Error '+r+"</div>"}c.showMessageWindow.alertError(z).done(function(D){})}else{C.error({title:j("<span>{{'COMMONS.MESSAGES.MSG_ERROR'|translate}} "+u[v].code+"!</span>")(n),content:z,append:false,autoHide:y[v].timeWait,icon:"<span class='glyphicon glyphicon-remove-circle'></span>"})}break;case c.constant.TYPEMESSAGE.INFO:if(q){c.showMessageWindow.alertInfo(c.translate(y[v].message,w)).done(function(D){})}else{C.info({title:j("<span>{{'COMMONS.MESSAGES.MSG_INFO'|translate}}!</span>")(n),content:z,append:false,autoHide:y[v].timeWait,icon:"<span class='glyphicon glyphicon-info-sign'></span>"})}break;case c.constant.TYPEMESSAGE.SUCCESS:if(y[v].timeWait===undefined||y[v].timeWait===0){y[v].timeWait=c.constant.DEFAULT_DELAY_TIME_SUCCESS_NOTIFICATION}if(q){c.showMessageWindow.alertSuccess(c.translate(y[v].message,w)).done(function(D){})}else{C.success({title:j("<span>{{'COMMONS.MESSAGES.MSG_SUCCES'|translate}}!</span>")(n),content:z,append:false,autoHide:y[v].timeWait,icon:"<span class='glyphicon glyphicon-ok-circle'></span>"})}break;case c.constant.TYPEMESSAGE.CONFIRM:A=c.showMessageWindow.confirm(c.translate(y[v].message,w)).done(function(){});break;default:C.info({title:j("<span>{{'COMMONS.MESSAGES.MSG_INFO'|translate}}</span>")(n),content:z,append:true,autoHide:y[v].timeWait});break}}return A}function l(u){var r,t,s,v=c.getMessageManager(),q,w;if(u.error.length>0){for(q=0;q<u.error.length;q+=1){w=u.error[q];r=w.groupId;t=w.message;s=w.parameters;v.showGroupMessagesError(r,t,s)}}if(u.info.length>0){for(q=0;q<u.info.length;q+=1){w=u.info[q];r=w.groupId;t=w.message;s=w.parameters;v.showGroupMessagesInfo(r,t,s)}}if(u.success.length>0){for(q=0;q<u.success.length;q+=1){w=u.success[q];r=w.groupId;t=w.message;s=w.parameters;v.showGroupMessagesSuccess(r,t,s)}}}function h(r){var q=[];if(r instanceof Array){q=r}else{q.push({message:r})}return q}function k(s,q,r,u,t){if(q.length>0){if(r.length>0){r.remove()}q.last().after("<div id='"+s+"_msg' class='alert alert-"+t+"' role='alert'><span class='glyphicon glyphicon-exclamation-sign' aria-hidden='true'></span><span class='sr-only'>Error:</span>"+u+"</div>");q.last().hide()}else{c.logging.getLoggerManager().warn("showGroupMessages: No existe el Grupo especificado ->"+s)}}return{showMessagesError:function(s,q,t,u){var r=h(s);r.forEach(function(v){v.type=c.constant.TYPEMESSAGE.ERROR;v.showAsWindow=b.isUndefined(v.showAsWindow)?q:v.showAsWindow;v.timeWait=b.isUndefined(v.timeWait)?u:v.timeWait;v.parameters=b.isUndefined(v.parameters)?t:v.parameters;v.code=-1});p(r)},showTranslateMessagesError:function(r,s,t,q){this.showMessagesError(r,q,s,t)},showMessagesInformation:function(s,q,t,u){var r=h(s);r.forEach(function(v){v.type=c.constant.TYPEMESSAGE.INFO;v.showAsWindow=b.isUndefined(v.showAsWindow)?q:v.showAsWindow;v.timeWait=b.isUndefined(v.timeWait)?u:v.timeWait;v.parameters=b.isUndefined(v.parameters)?t:v.parameters;v.code=-1});p(r)},showMessagesConfirm:function(s){var q=h(s),r;q.forEach(function(t){t.type=c.constant.TYPEMESSAGE.CONFIRM});r=p(q);return r},showTranslateMessagesInfo:function(r,s,t,q){this.showMessagesInformation(r,q,s,t)},showMessagesSuccess:function(s,q,t,u){var r=h(s);r.forEach(function(v){v.type=c.constant.TYPEMESSAGE.SUCCESS;v.showAsWindow=b.isUndefined(v.showAsWindow)?q:v.showAsWindow;v.timeWait=b.isUndefined(v.timeWait)?u:v.timeWait;v.parameters=b.isUndefined(v.parameters)?t:v.parameters;v.code=-1});p(r)},showTranslateMessagesSuccess:function(r,s,t,q){this.showMessagesSuccess(r,q,s,t)},showMessages:function(r){var q=h(r);p(q)},showAllMessages:function(s){var v=[],q=[],u=[],t={error:[],info:[],success:[]},r;for(r=0;r<s.length;r+=1){switch(s[r].type){case 0:if(!s[r].groupId||s[r].groupId==""){v.push(s[r])}else{t.error.push(s[r])}break;case 1:if(!s[r].groupId||s[r].groupId==""){q.push(s[r])}else{t.info.push(s[r])}break;case 2:if(!s[r].groupId||s[r].groupId==""){u.push(s[r])}else{t.success.push(s[r])}break}}if(v.length>0){p(v,0)}if(q.length>0){p(q,1)}if(u.length>0){p(u,2)}l(t)},showGroupMessagesError:function(s,u,v){var q=d("[ng-class*="+s+"]"),r=d("#"+s+"_msg"),t;if(u.length>0&&r.length===0){t=c.translate(u,v);k(s,q,r,t,"danger")}else{if(r.length>0&&u.length===0){r.remove();q.last().show()}}},showGroupMessagesInfo:function(s,u,v){var q=d("[ng-class*="+s+"]"),r=d("#"+s+"_msg"),t;if(u.length>0&&r.length===0){t=c.translate(u,v);k(s,q,r,t,"info")}else{if(r.length>0&&u.length===0){r.remove();q.last().show()}}},showGroupMessagesSuccess:function(s,u,v){var q=d("[ng-class*="+s+"]"),r=d("#"+s+"_msg"),t;if(u.length>0&&r.length===0){t=c.translate(u,v);k(s,q,r,t,"success")}else{if(r.length>0&&u.length===0){r.remove();q.last().show()}}}}}]);e.service(c.modules.CONTAINER+".modalService",["$modal",function(h){var i={backdrop:true,keyboard:true,modalFade:true,templateUrl:"${contextPath}/cobis/web/views/commons/templates/modal.html"},g={closeButtonText:"Close",actionButtonText:"OK",headerText:"Proceed?",bodyText:"Perform this action?"};this.showModal=function(j,k){if(!j){j={}}j.backdrop="static";return this.show(j,k)};this.show=function(k,l){var m={},j={};b.extend(m,i,k);b.extend(j,g,l);if(!m.controller){m.controller=function(n,o){n.modalOptions=j;n.modalOptions.ok=function(p){o.close(p)};n.modalOptions.close=function(p){o.dismiss("cancel")}}}return h.open(m)}}]);e.controller("keepAliveCen.Controller",["$scope",c.modules.CONTAINER+".containerInfoService",function(g,h){b.element(document).ready(function(){if(c.userContext.getValue(c.constant.RUNNINGONCEN)=='"yes"'||c.userContext.getValue(c.constant.RUNNINGONCEN)=="yes"){var i=window.external.KeepAliveSessionCobis5();if(i||typeof window.keepAliveInterval==="undefined"||window.keepAliveInterval===null){window.keepAliveInterval=setInterval(h.keepAliveSessionOnCen,180000)}}})}])}(window.angular,window.kendo,window.kendo.jQuery,window.kiui,window.cobis));